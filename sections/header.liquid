{%- liquid
  # Header State Logic
  # - transparent: Used on pages with hero images (overlays content)
  # - solid: Used on standard pages (stacks with content)
  # - sticky: Triggered after scrolling 300px (always uses solid styling)

  assign logo_light = settings.logo_light
  assign logo_dark = settings.logo_dark
  assign logo_width = settings.logo_width | default: 150

  # Determine if header should start as transparent or solid
  assign is_transparent_page = false
  if template.name == 'index' or template.name == 'collection'
    assign is_transparent_page = true
  endif
-%}

{{ 'section-header.css' | asset_url | stylesheet_tag }}

<header
  x-data="headerAnimation({{ is_transparent_page }})"
  :class="{
    'section-header--solid': sticky,
    'section-header--transparent': !sticky
  }"
  class="section-header"
>
  <div class="section-header__container">
    
    {%- comment -%} LEFT GROUP: Hamburger Menu + Search {%- endcomment -%}
    <div class="section-header__left">
      {%- comment -%} Hamburger Menu Button {%- endcomment -%}
      <button
        @click="menuOpen = !menuOpen"
        @mouseenter="animateHamburgerEnter($el)"
        @mouseleave="animateHamburgerExit($el)"
        aria-label="Toggle Menu"
        :class="{ 'section-header__button--dark': sticky, 'section-header__button--light': !sticky }"
        class="section-header__button section-header__hamburger"
      >
        {{ 'icon-header-hamburger-menu.svg' | inline_asset_content }}
      </button>

      {%- comment -%} Search Button - Desktop/Tablet (with text) {%- endcomment -%}
      <button
        @click="searchOpen = !searchOpen"
        @mouseenter="animateTextEnter($el)"
        @mouseleave="animateTextExit($el)"
        aria-label="Search"
        :class="{ 'section-header__button--dark': sticky, 'section-header__button--light': !sticky }"
        class="section-header__button section-header__search-button"
      >
        {{ 'icon-header-search.svg' | inline_asset_content }}
        <span class="section-header__search-text-wrapper">
          <span class="section-header__search-text">Search</span>
          <div class="section-header__underline"></div>
        </span>
      </button>

      {%- comment -%} Search Icon Only - Mobile {%- endcomment -%}
      <button
        @click="searchOpen = !searchOpen"
        aria-label="Search"
        :class="{ 'section-header__button--dark': sticky, 'section-header__button--light': !sticky }"
        class="section-header__button section-header__search-icon"
      >
        {{ 'icon-header-search.svg' | inline_asset_content }}
      </button>
    </div>

    {%- comment -%} CENTER GROUP: Logo {%- endcomment -%}
    <div class="section-header__logo-wrapper">
      {%- comment -%} DEBUG: logo_light={{ logo_light | default: 'EMPTY' }}, logo_dark={{ logo_dark | default: 'EMPTY' }} {%- endcomment -%}
      <a 
        href="{{ routes.root_url }}" 
        class="section-header__logo-link"
      >
        {%- if logo_light != blank and logo_dark != blank -%}
          {%- comment -%} Both logos exist - switch based on sticky state {%- endcomment -%}
          <img
            x-show="!sticky"
            src="{{ logo_light | image_url: width: logo_width }}"
            alt="{{ shop.name }} - Light"
            width="{{ logo_width }}"
            height="52"
            class="section-header__logo-image"
            loading="eager"
          >
          <img
            x-show="sticky"
            src="{{ logo_dark | image_url: width: logo_width }}"
            alt="{{ shop.name }} - Dark"
            width="{{ logo_width }}"
            height="52"
            class="section-header__logo-image"
            style="display: none;"
            loading="eager"
          >
        {%- elsif logo_light != blank -%}
          {%- comment -%} Only light logo - always show {%- endcomment -%}
          <img
            src="{{ logo_light | image_url: width: logo_width }}"
            alt="{{ shop.name }}"
            width="{{ logo_width }}"
            height="52"
            class="section-header__logo-image"
            loading="eager"
          >
        {%- elsif logo_dark != blank -%}
          {%- comment -%} Only dark logo - always show {%- endcomment -%}
          <img
            src="{{ logo_dark | image_url: width: logo_width }}"
            alt="{{ shop.name }}"
            width="{{ logo_width }}"
            height="52"
            class="section-header__logo-image"
            loading="eager"
          >
        {%- else -%}
          {%- comment -%} No logos - show text {%- endcomment -%}
          <span 
            :class="{ 'section-header__logo-text--dark': sticky, 'section-header__logo-text--light': !sticky }"
            class="section-header__logo-text"
          >
            {{ shop.name }}
          </span>
        {%- endif -%}
      </a>
    </div>

    {%- comment -%} RIGHT GROUP: Account/Login + Cart {%- endcomment -%}
    <div class="section-header__right">
      
      {%- comment -%} Account/Login - Desktop & Tablet (Text) {%- endcomment -%}
      {% if shop.customer_accounts_enabled %}
        <a
          href="{{ routes.account_url }}"
          @mouseenter="animateTextEnter($el)"
          @mouseleave="animateTextExit($el)"
          :class="{ 'section-header__account-link--dark': sticky, 'section-header__account-link--light': !sticky }"
          class="section-header__account-link"
        >
          <span class="section-header__account-text-wrapper">
            <span class="section-header__account-text">
              {%- if customer -%}
                Account
              {%- else -%}
                Login/Signup
              {%- endif -%}
            </span>
            <div class="section-header__underline"></div>
          </span>
        </a>

        {%- comment -%} Account Icon - Mobile {%- endcomment -%}
        <a
          href="{{ routes.account_url }}"
          @mouseenter="animateIconFillEnter($el)"
          @mouseleave="animateIconFillExit($el)"
          aria-label="Account"
          :class="{ 'section-header__account-icon--dark': sticky, 'section-header__account-icon--light': !sticky }"
          class="section-header__account-icon"
        >
          {%- comment -%} Transparent header: White icons {%- endcomment -%}
          <span x-show="!sticky" class="icon-stack">
            <span class="icon-outline">{{ 'icon-user-white-outline.svg' | inline_asset_content }}</span>
            <span class="icon-filled">{{ 'icon-user-white-fill.svg' | inline_asset_content }}</span>
          </span>
          {%- comment -%} Sticky header: Black icons {%- endcomment -%}
          <span x-show="sticky" style="display: none;" class="icon-stack">
            <span class="icon-outline">{{ 'icon-user-black-outline.svg' | inline_asset_content }}</span>
            <span class="icon-filled">{{ 'icon-user-black-fill.svg' | inline_asset_content }}</span>
          </span>
        </a>
      {% endif %}

      {%- comment -%} Cart Icon {%- endcomment -%}
      <a
        href="{{ routes.cart_url }}"
        @mouseenter="animateIconFillEnter($el)"
        @mouseleave="animateIconFillExit($el)"
        aria-label="Cart ({{ cart.item_count }} items)"
        :class="{ 'section-header__cart-link--dark': sticky, 'section-header__cart-link--light': !sticky }"
        class="section-header__cart-link"
      >
        {%- comment -%} Transparent header: White t-shirt {%- endcomment -%}
        <span x-show="!sticky" class="icon-stack">
          <span class="icon-outline">{{ 'icon-tshirt-white-outline.svg' | inline_asset_content }}</span>
          <span class="icon-filled">{{ 'icon-tshirt-white-fill.svg' | inline_asset_content }}</span>
        </span>
        {%- comment -%} Sticky header: Black t-shirt {%- endcomment -%}
        <span x-show="sticky" style="display: none;" class="icon-stack">
          <span class="icon-outline">{{ 'icon-tshirt-black-outline.svg' | inline_asset_content }}</span>
          <span class="icon-filled">{{ 'icon-tshirt-black-fill.svg' | inline_asset_content }}</span>
        </span>

        {%- comment -%} Cart Badge - Orange dot if items present {%- endcomment -%}
        {% if cart.item_count > 0 %}
          <span class="section-header__cart-badge"></span>
        {% endif %}
      </a>
    </div>

  </div>
</header>

{%- comment -%}
  NOTE: Body padding for solid header (stacked mode) should be handled
  at the layout level or per-page template using pt-header class
{%- endcomment -%}

<script src="{{ 'section-header.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Header",
  "settings": [],
  "class": "header-section"
}
{% endschema %}
