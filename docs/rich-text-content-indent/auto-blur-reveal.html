<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Random Blur Reveal - GSAP ScrollTrigger</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            overflow-x: hidden;
        }

        .spacer {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
        }

        .reveal-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 100px 20px;
        }

        .reveal-container {
            max-width: 1200px;
            width: 100%;
        }

        h1 {
            font-size: clamp(2rem, 5vw, 4rem);
            line-height: 1.3;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        /* Character wrapper styles */
        .word-wrapper {
            display: inline-block;
            margin-right: 0.3em;
        }

        .char-wrapper {
            position: relative;
            display: inline-block;
        }

        .char-inner {
            position: relative;
            display: inline-block;
            filter: blur(10px);
            opacity: 0;
            will-change: filter, opacity;
        }

        /* Revealed state */
        .char-inner.revealed {
            filter: blur(0px);
            opacity: 1;
            transition: filter 0.6s ease, opacity 0.6s ease;
        }

        /* Preserve spaces */
        .space {
            display: inline-block;
            width: 0.3em;
        }

        /* Info section */
        .info {
            text-align: center;
            padding: 50px 20px;
            color: #666;
            font-size: 14px;
        }

        .scroll-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 12px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        /* Highlight for demo */
        .spacer:first-child {
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
        }

        .spacer:last-child {
            background: linear-gradient(180deg, #1a1a1a 0%, #0a0a0a 100%);
        }
    </style>
</head>
<body>
    <div class="scroll-indicator">Animation: <span id="status">Waiting...</span></div>
    
    <div class="spacer">
        <h2 style="font-size: 2rem;">⬇️ Scroll Down to See Animation ⬇️</h2>
    </div>
    
    <div class="reveal-section">
        <div class="reveal-container">
            <h1 id="revealText">
                Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.
            </h1>
        </div>
    </div>
    
    <div class="spacer">
        <h2 style="font-size: 2rem;">⬆️ Scroll Up to See It Again ⬆️</h2>
    </div>
    
    <div class="info">
        <p>Auto Random Character Blur Reveal Animation using GSAP ScrollTrigger</p>
        <p>Animation plays automatically when section enters viewport</p>
        <p>No scroll pinning - natural scrolling experience</p>
    </div>

    <!-- GSAP and ScrollTrigger -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

    <script>
        // Register ScrollTrigger plugin
        gsap.registerPlugin(ScrollTrigger);

        class AutoRandomBlurReveal {
            constructor(element, options = {}) {
                this.element = element;
                this.text = element.textContent;
                this.chars = [];
                this.options = {
                    duration: options.duration || 2, // Total animation duration in seconds
                    stagger: options.stagger || 0.02, // Delay between each character
                    triggerStart: options.triggerStart || 'top 80%',
                    reset: options.reset || true // Reset animation when scrolling back
                };
                this.init();
            }

            init() {
                // Clear the original text
                this.element.innerHTML = '';
                
                // Split text into words and characters
                const words = this.text.trim().split(' ');
                
                words.forEach((word, wordIndex) => {
                    // Create word wrapper
                    const wordWrapper = document.createElement('span');
                    wordWrapper.className = 'word-wrapper';
                    
                    // Split word into characters
                    word.split('').forEach((char, charIndex) => {
                        const charWrapper = document.createElement('span');
                        charWrapper.className = 'char-wrapper';
                        
                        const charInner = document.createElement('span');
                        charInner.className = 'char-inner';
                        charInner.textContent = char;
                        
                        charWrapper.appendChild(charInner);
                        wordWrapper.appendChild(charWrapper);
                        
                        // Store reference to character element
                        this.chars.push(charInner);
                    });
                    
                    this.element.appendChild(wordWrapper);
                    
                    // Add space after word (except last word)
                    if (wordIndex < words.length - 1) {
                        const space = document.createElement('span');
                        space.className = 'space';
                        space.innerHTML = '&nbsp;';
                        this.element.appendChild(space);
                    }
                });

                this.createAnimation();
            }

            createAnimation() {
                // Create a randomized array of indices
                const totalChars = this.chars.length;
                const indices = Array.from({ length: totalChars }, (_, i) => i);
                
                // Fisher-Yates shuffle for true randomization
                for (let i = indices.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [indices[i], indices[j]] = [indices[j], indices[i]];
                }

                // Create timeline for automatic animation
                const tl = gsap.timeline({
                    paused: true,
                    onStart: () => {
                        document.getElementById('status').textContent = 'Playing...';
                    },
                    onComplete: () => {
                        document.getElementById('status').textContent = 'Complete!';
                    }
                });

                // Animate characters in random order with stagger
                indices.forEach((charIndex, index) => {
                    tl.call(() => {
                        this.chars[charIndex].classList.add('revealed');
                    }, [], index * this.options.stagger);
                });

                // ScrollTrigger to play animation when entering viewport
                ScrollTrigger.create({
                    trigger: this.element,
                    start: this.options.triggerStart,
                    end: 'bottom 20%',
                    onEnter: () => {
                        tl.restart();
                    },
                    onLeaveBack: () => {
                        if (this.options.reset) {
                            this.resetAnimation();
                            document.getElementById('status').textContent = 'Reset';
                        }
                    },
                    onEnterBack: () => {
                        if (this.options.reset) {
                            tl.restart();
                        }
                    },
                    markers: false // Set to true for debugging
                });
            }

            resetAnimation() {
                // Remove revealed class from all characters
                this.chars.forEach(char => {
                    char.classList.remove('revealed');
                });
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            const revealElement = document.getElementById('revealText');
            
            // Create instance with custom options
            new AutoRandomBlurReveal(revealElement, {
                duration: 2,      // 2 seconds total
                stagger: 0.015,   // 15ms between each character
                triggerStart: 'top 75%',
                reset: true       // Reset when scrolling back up
            });
        });
    </script>
</body>
</html>
